clc;
clear;
close all;


X1=[0.312
1.663
2.911
3.742
4.99
6.445
7.277
8.524
9.563
10.603
11.85
12.89
14.137
14.969
16.424
17.672
18.503
19.335
20.166
20.79
21.414
22.245
23.701
24.532
25.572
26.195
26.611
27.443
28.274
29.106
30.146
30.977
31.809
32.848
33.68
34.927
35.967
37.214
38.669
39.917
40.956
41.58
42.827];

X2=[44.075
44.906
46.778
48.025
49.48
51.559
53.015
54.678
56.133
57.588
59.044
60.499
61.123
62.578
63.41
64.865
65.904
67.152
67.775
68.815
70.27
71.102
71.726
73.597
74.22
75.26
75.884
76.715
78.794
80.249
82.121
83.368
85.031
87.11
88.565
90.437
91.476
93.139
94.802
96.258
97.297
99.272];


Y1=[27.811
27.811
27.811
27.264
26.716
25.896
24.801
24.254
23.433
22.612
21.244
20.423
18.781
17.96
16.045
14.403
13.035
11.94
11.393
10.025
8.657
7.562
5.647
3.731
2.637
1.269
0.174
-0.647
-2.015
-2.836
-4.478
-6.119
-6.94
-8.035
-9.403
-10.498
-11.592
-13.234
-14.328
-14.876
-15.97
-16.791
-17.886];

Y2=[-18.159
-18.706
-19.527
-19.801
-19.801
-19.801
-19.254
-18.706
-17.338
-15.697
-13.781
-12.139
-10.771
-8.308
-6.393
-4.478
-2.562
-0.647
1.816
4.552
6.468
9.478
11.393
13.308
16.045
17.96
19.055
20.697
22.612
24.527
25.896
26.99
27.537
27.537
27.537
27.537
27.537
27.537
27.537
27.537
27.537
27.537];

X=[X1;X2];
Y=[Y2;Y1];
figure;
plot(X,Y);
title('Left Hip Cycle with data');
xlabel('% Cycle');
Wa=polyfit(X,Y,15);

syms t
XX=Wa(1)*t.^15+Wa(2)*t.^14+Wa(3)*t.^13+Wa(4)*t.^12+Wa(5)*t.^11++Wa(6)*t.^10+Wa(7)*t.^9+Wa(8)*t.^8+Wa(9)*t.^7+Wa(10)*t.^6+Wa(11)*t.^5+Wa(12)*t.^4+Wa(13)*t.^3+Wa(14)*t.^2+Wa(15).*t+Wa(16);
XX=vpa(XX,10);

XXd=diff(XX,t);
XXd=vpa(XXd,10);

XXdd=diff(XXd,t);
XXdd=vpa(XXdd,10);

tt=0:0.01:100;
XXn=Wa(1)*tt.^15+Wa(2)*tt.^14+Wa(3)*tt.^13+Wa(4)*tt.^12+Wa(5)*tt.^11++Wa(6)*tt.^10+Wa(7)*tt.^9+Wa(8)*tt.^8+Wa(9)*tt.^7+Wa(10)*tt.^6+Wa(11)*tt.^5+Wa(12)*tt.^4+Wa(13)*tt.^3+Wa(14)*tt.^2+Wa(15).*tt+Wa(16);
figure;
plot(tt,XXn);
title('Left Hip Cycle');
xlabel('% Cycle');